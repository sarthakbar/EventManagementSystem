<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Event Polls</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet">
</head>

<body class="bg-light">

<div class="container py-5">

    <!-- Page Header -->
    <div class="mb-4 p-4 rounded shadow-sm bg-white border-start border-4 border-primary">
        <h3 class="fw-bold text-primary mb-1"
            th:text="${event.title} + ' — Polls'"></h3>
        <p class="text-muted mb-0">
            Cast your vote and view live poll participation.
        </p>
    </div>

    <!-- No Polls -->
    <div th:if="${#lists.isEmpty(polls)}"
         class="alert alert-warning text-center py-4 rounded shadow-sm">
        <strong>No polls available</strong><br>
        Polls for this event will appear here once created.
    </div>

    <!-- Polls -->
    <div th:if="${!#lists.isEmpty(polls)}">

        <div th:each="poll : ${polls}"
             class="card mb-4 border-0 shadow-sm">

            <!-- Card Header -->
            <div class="card-header bg-primary bg-opacity-10 border-0">
                <h6 class="fw-semibold text-primary mb-0">
                    Poll Question
                </h6>
            </div>

            <div class="card-body">

                <!-- Question -->
                <h5 class="fw-semibold text-dark mb-3"
                    th:text="${poll.question}"></h5>

                <!-- Vote Form -->
                <form th:action="@{/polls/vote}" method="post">

                    <input type="hidden"
                           name="eventId"
                           th:value="${event.id}"/>

                    <!-- Options -->
                    <div th:each="opt : ${poll.options}"
                         class="mb-3 p-2 rounded bg-light">

                        <div class="form-check">
                            <input class="form-check-input"
                                   type="radio"
                                   name="optionId"
                                   th:value="${opt.id}"
                                   required>

                            <label class="form-check-label fw-medium"
                                   th:text="${opt.optionText}"></label>
                        </div>

                        <small class="text-muted ms-4">
                            Votes:
                            <span class="fw-semibold text-secondary"
                                  th:text="${opt.voteCount}"></span>
                        </small>

                    </div>

                    <!-- Submit -->
                    <button type="submit"
                            class="btn btn-primary btn-sm px-4 mt-2">
                        Submit Vote
                    </button>

                </form>

            </div>
        </div>

    </div>

    <!-- Back Button -->
    <div class="mt-4">
        <a th:href="@{/dashboard}"
           class="btn btn-outline-secondary">
            ← Back to Dashboard
        </a>
    </div>

</div>

</body>
</html>
